<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Start the Lambda runtime — start_lambda • lambdr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Start the Lambda runtime — start_lambda"><meta property="og:description" content="This is the main function of the package, responsible for starting the
infinite loop of listening for new invocations. It relies on configuration
provided to the config argument and produced by the
lambda_config function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lambdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/api-gateway-invocations.html">API Gateway Invocations</a>
    </li>
    <li>
      <a href="../articles/context.html">Using invocation context</a>
    </li>
    <li>
      <a href="../articles/eventbridge-and-sns-invocations.html">EventBridge and SNS Invocations</a>
    </li>
    <li>
      <a href="../articles/lambda-runtime-in-container.html">Placing an R Lambda Runtime in a Container</a>
    </li>
    <li>
      <a href="../articles/package-structure.html">Package Structure</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mdneuzerling/lambdr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Start the Lambda runtime</h1>
    <small class="dont-index">Source: <a href="https://github.com/mdneuzerling/lambdr/blob/HEAD/R/start-lambda.R" class="external-link"><code>R/start-lambda.R</code></a></small>
    <div class="hidden name"><code>start_lambda.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function of the package, responsible for starting the
infinite loop of listening for new invocations. It relies on configuration
provided to the <code>config</code> argument and produced by the
<code><a href="lambda_config.html">lambda_config</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">start_lambda</span><span class="op">(</span></span>
<span>  config <span class="op">=</span> <span class="fu"><a href="lambda_config.html">lambda_config</a></span><span class="op">(</span>environ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  timeout_seconds <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>config</dt>
<dd><p>A list of configuration values as created by the
<code>lambda_config</code> function.</p></dd>


<dt>timeout_seconds</dt>
<dd><p>If set, the function will stop listening for events
after this timeout. The timeout is checked between events, so this won't
interrupt the function while it is waiting for a new event. This argument
is provided for testing purposes, and shouldn't otherwise need to be set:
AWS should handle the shutdown of idle Lambda instances.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>See <code><a href="../articles/lambda-runtime-in-container.html">vignette("lambda-runtime-in-container", package = "lambdr")</a></code> for an
example of how to use this function to place an R Lambda Runtime in a
container.</p>
<p>This package uses the <code><a href="https://daroczig.github.io/logger/reference/logger.html" class="external-link">logger</a></code> package for logging.
Debug log entries can be enabled with <code>logger::log_threshold(logger::DEBUG)</code>.
This will log additional information such as raw event bodies.</p>
    </div>
    <div id="event-context">
    <h2>Event context</h2>
    

<p>Context is metadata associated with each invocation. If the handler function
accepts a <code>context</code> argument then it will automatically receive at runtime a
named list consisting of these values along with the arguments in the body
(if any). For example, a function such as <code>my_func(x, context)</code> will receive
the context argument automatically. The <code>context</code> argument must be named
(<code>...</code> will not work).</p>
<p>Refer to <code><a href="../articles/lambda-runtime-in-container.html">vignette("lambda-runtime-in-container", package = "lambdr")</a></code>
for details.</p>
    </div>
    <div id="aws-lambda-variables">
    <h2>AWS Lambda variables</h2>
    


<p>The <code><a href="lambda_config.html">lambda_config</a></code> function obtains the configuration values
for the Lambda runtime configures the R session for Lambda based on
environment variables made available by Lambda. The following environment
variables are available:</p><ul><li><p>Lambda Runtime API, available as the "AWS_LAMBDA_RUNTIME_API" environment
variable, is the host of the various HTTP endpoints through which the
runtime interacts with Lambda.</p></li>
<li><p>Lambda Task Root, available as the "LAMBDA_TASK_ROOT" environment variable,
defines the path to the Lambda function code. It isn't used in container
environments with a custom runtime, as that runtime is responsible for
finding and sourcing the function code. Hence, a missing task root is
ignored by this package.</p></li>
<li><p>The handler, available as the "_HANDLER" environment variable, is
interpreted by R as the function that is executed when the Lambda is
called. This value could be anything, as the interpretation is solely up
to the runtime, so requiring it to be a function is a standard imposed by
this package.</p></li>
</ul><p>These <code>handler</code>, <code>runtime_api</code> and <code>task_root</code> arguments to the
<code><a href="lambda_config.html">lambda_config</a></code> function can also provide values to these
configuration options, although the environment variables will always be
used if available. While it may be sensible to provide the <code>handler</code>
function directly, the other two configuration options are only provided for
debugging and testing purposes.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># A general usage pattern involves sourcing necessary functions and running</span></span></span>
<span class="r-in"><span><span class="co"># this `start_lambda` in a `runtime.R` file which is then executed to start</span></span></span>
<span class="r-in"><span><span class="co"># the runtime. In the following example, the function handler can be set to</span></span></span>
<span class="r-in"><span><span class="co"># "lambda" either as the container `CMD`, or configured through AWS Lambda.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parity</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parity <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="st">"even"</span> <span class="kw">else</span> <span class="st">"odd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">start_lambda</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, it can be passed as an argument `handler = parity` to</span></span></span>
<span class="r-in"><span><span class="co"># the lambda configuration. If the handler is configured through other means</span></span></span>
<span class="r-in"><span><span class="co"># then this will be ignored:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">start_lambda</span><span class="op">(</span>config <span class="op">=</span> <span class="fu"><a href="lambda_config.html">lambda_config</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">parity</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Neuzerling.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

